{% extends "base.html" %}

{%block sidebar %}
<li><a href="/view_bdd" class="page-active">Base de données</a></li>
<li><a href="/create_odm">Création ODM</a></li>
<li><a href="/view_odm">Consulter ODM</a></li>
<li><a href="/gestion_user">Gestion utilisateurs</a></li>
{% endblock %}


{%block content %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/view_bdd.css') }}">

<h1>Consultation des bases de données</h1>
            <form action="{{ url_for('view_bdd') }}" method="POST">
                <div class="controls">
                    <div class="dropdown">
                        <select name="choix" onchange="this.form.submit()">
                            <option value="Personnes" {% if selection == 'Personnes' %}selected{% endif %}>Personnes</option>
                            <option value="Chantiers" {% if selection == 'Chantiers' %}selected{% endif %}>Chantiers</option>
                            <option value="Usines" {% if selection == 'Usines' %}selected{% endif %}>Usines</option>
                            <option value="Agences" {% if selection == 'Agences' %}selected{% endif %}>Agences</option>
                        </select>
                    </div>
                    <a class ="add-btn" href="/add_{{ selection }}">Ajouter {{ selection }}</a>
                </div>
            </form>
            <div class="table-container">
                <table>
                    <thead>
                        <tr>
                            {% if selection == 'Personnes' %}
                                <th>ID Personne</th>
                                <th>Nom</th>
                                <th>Prénom</th>
                                <th>Matricule</th>
                                <th>Téléphone</th>
                                <th>Immatriculation</th>
                                <th>Adresse</th>
                                <th>Code postal</th>
                                <th>Ville</th>
                                <th>Chargé d'affaire</th>
                                <th>Email</th>
                                <th>Agence Spie</th>
                                <th>Rôle</th>
                                <th>Action</th>
                            {% elif selection == 'Chantiers' %}
                                <th>ID Chantier</th>
                                <th>Client</th>
                                <th>Code affaire</th>
                                <th>Usine</th>
                                <th>Contact</th>
                                <th>Action</th>
                            {% elif selection == 'Usines' %}
                                <th>ID Usine</th>
                                <th>Entreprise</th>
                                <th>Adresse</th>
                                <th>Code postal</th>
                                <th>Ville</th>
                                <th>Action</th>
                            {% elif selection == 'Agences' %}
                                <th>ID Agence</th>
                                <th>Ville</th>
                                <th>Action</th>
                            {% endif %}
                        </tr>
                    </thead>
                    <tbody>
                        {% for row in data %}
                            <tr>
                                {% for value in row %}
                                <td>
                                    {% if value is none %}
                                        &nbsp;  <!-- Affiche une cellule vide -->
                                    {% else %}
                                        {{ value }}
                                    {% endif %}
                                </td>
                                    {% endfor %}
                                <td>
                                    <form action="{{ url_for('delete_item', type=selection, id=row[0]) }}" method="POST">
                                        <button type="submit" class="delete-btn">Supprimer</button>
                                        <a class="edit-btn" href="{{ url_for('edit_item', type=selection, id=row[0]) }}">Modifier</a>
                                    </form>
                                </td>
                                
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

{% endblock %}